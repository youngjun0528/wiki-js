---
title: TEST
description: 
published: true
date: 2023-01-19T03:00:27.672Z
tags: 
editor: markdown
dateCreated: 2022-04-13T06:51:08.738Z
---

# 테스트
## 격리 테스트(순수 단위 테스트)
애플리케이션 로직을 검증
하나의 독립된 코드 단위로 테스트하는 것으로 테스트 실패나 성공이 외부 코드에 영향을 받지 않는다.
프로그래머 관점에서 그 내부를 테스트한다.
### 특징
가장 작업이 어렵다.
읽고 이해하기 어렵다.
실행속도가 빠르다.
좋은 코드 설계를 실현하는 최적의 방법이다.


## 통합 테스트
코드가 다른 외부 시스템과 정상적으로 연계되었는지를 확인하는 테스트
기능이 다른 시스템에 의존한다건가 다른 시스템이 테스트 결과에 영향을 줄 수 있다.
### 특징
빠르게 작성할 수 있다.
이해하기 쉽다.
연계부분에서 발생하는 문제 파악이 쉽다.

## 시스템 테스트
애플리케이션 내에 있는 여러 시스템들과의 연계성을 테스트(DB, Redis 등 정적 Resource 와의 연계)
위의 통합 테스트과 비슷하다.

## 기능 및 승인 테스트
사용자 관점에서의 애플리케이션 테스트
### 특징
애플리케이션이 정상적으로 동작한다는 것을 보증한다.
피드백 주기가 느리다.
간결한 코드작성에 도움이 되지 않는다.

# 순수 단위 테스트의 단점
1. 이해하기 힘들고 작성하기 힘들다.
2. 자동으로 테스트를 통합하지 않는다. : 테스트 내에 포함된 하나의 단위(Unit) 만 격리상태로 테스트한다. 각 단위간 통합 처리는 테스트 하지 않는다.
3. 예측하지 못한 버그를 잡을 수 없다. : 경계값 오류나 로직 오류 등의 예상된 오류는 잡을 수 있으나 예측 하지 못한 버그는 잡을 수 없다.
4. Mock 테스트는 코드 구현과 밀접하게 연계된다. : 구현된 코드가 변경되면 Mock 테스트도 같이 변경되어야 한다.

# 테스트의 목적
1. 정확성 : 버그가 없는 코드 구현이 목표
2. 간결하고 유지 관리가 용이한 코드 구현
3. 생산적인 작업 흐름

# 일반적인 테스트 방향성
- 하나의 테스트는 하나의 기능만 테스트 해야한다.
- 애플리케이션 소스 파일 하나당 하나의 테스트 파일
- 각 함수 및 클래스가 적어도 하나의 테스트 틀을 가지고 있어야 한다.
- 상수는 테스트하지 말라
- 코드 자체 보다는 처리방식을 테스트
- 모든 가능한 패턴과 에러가 발생할 수 있는 경우를 생각하라.

# TDD
1. 기능 테스트를 작성해서 사용자 관점의 새로운 기능성을 정의한다. - 여기서는 API Spec 문서와 Postman Test Script
2. 기능 테스트를 기반으로 내부에서 어떻게 하면 테스트를 통과할 수 있는지 최소한 하나이상의 단위 테스트에 의해 기능을 구현한다.
3. 1과 2의 절차를 반복한다. ( 기능 테스트를 상위 / 단위 테스트를 하위 개념)
4. 리팩터링이 필요한지 파악한다. - 기능테스트와 단위 테스트를 믿고 진행한다.

# 테스트 구조화와 리팩터링 
## 테스트 폴더 사용
- 기능 테스트를 위해 기능이나 사용자 스토리 단위로 테스트를 그룹화 한다.
- 단위 테스트를 위해 테스트 대상 코드 파일별로 별도 테스트 파일을 만든다.(test_model.py etc...)
- 하나의 기본 테스트를 만들어서 다르 함수와 클래스가 이를 사용하도록 한다.
## 리팩터링
- 실패 테스트 상태에서 리팩터링 하지 않는다.

# Python Mock
- 외부 API와의 독립성을 보장하기 위해 사용되는 라이브러리
- Patch Decorator : 테스트에 필요한 모든 객체를 Mock Out 가능하다.
- Mock은 진짜 같아서 에러도 숨길 수 있다.
- 너무 많은 Mock을 사용하면 code smell 위험성이 있다.


